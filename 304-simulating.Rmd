---
title: "The policy Ontario people care the most for 2022 Ontario General Election"
subtitle: "STA304 - Fall 2020"
author: "Ziyue Yang"
# Student Number: 1004804759
date: "03/10/2020"
output: pdf_document
---

```{r setup, include=FALSE}
# Setting seed as the last 4 digits of my student number
set.seed(4759)
library(tidyverse)
# Global settings for figure sizes and echo.
require("knitr")
opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)
opts_chunk$set(engine = "R")
knitr::opts_chunk$set(echo = T)
knitr::opts_chunk$set(message = F)
knitr::opts_chunk$set(warning = F)
```


```{r "Data Simulation", include=FALSE}
# We begin with storing choices in vectors
# which will be used for sampling in the next chunk
# For section 'citizenship'
citizenship <- c("Canadian Citizen", "Permanent Resident", "Other")
# For section 'Personal Background'
# On what basis do you assess a political candidate?
basis <- c("News on TV", "Articles in the newspaper", "Attend events where the candidate is addressing the people", "I research all the all the channels before making my choice", "Number of fundraisers the candidate has done in you area", "The family upbringing of the candidate", "Other")
# What decade were you born in? 
decade <- c('1930-1949', '1950-1969', '1970-1989', '1990-2010')
# How do you identify yourself?
gender <- c("Female", "Male", "Prefer not to say")
# Does your household income fall into one of these broad ranges?
income <- c("0", "$1-$50,000", "$50,000-$100,000", "$100,000-$150,000", "$150,000-$200,000", "More then $200,000", "Prefer not to say")
# What is the highest level education that you have completed?
education <- c("No schooling", "Completed elementary school", "Completed high school", "Completed technical, community College, CEGEP, collage Classique", "Bachelor's degree", "Master's degree", "Professional degree or doctorate", "Prefer not to say")
# What is your employment status?
employment <- c("Working for pay full-time", "Working for pay part-time", "Self-employed", "Unemployed/looking for work", "Student", "Other")
# If you could vote in this election, which party do you think you will vote for?
# We use the vector 'party' below
# party_noncitizen <- c("Liberal", "NDP", "Conserv", "Green", "Other")
# ADD NONCITIZEN?
# ---
# Section Political Leanings, citizen
party <- c("Liberal", "NDP", "Conserv", "Green", "Other")
# Which party did you vote in last election?
last_vote <- c("Liberal", "NDP", "Conserv", "Green", "Other")
# Do you think the existing government is going in the right direction to benefit the people of the country?
right_dir <- c("Yes", "No", "Maybe")
# How likely are you gonna vote in the upcoming
likely_vote <- c(1:10)
# Which party are you gonna vote?
will_vote <- c("Liberal", "NDP", "Conserv", "Green", "Don't know")
# What’s the most important problem facing Canada today?
problem <- c("Economy generally", "Unemployment", "Healthcare", "Crime", "Immigration", "Environmental Issue", "Other")
# ---
# Choices for section 'Policy'
# What issue do you focus more on?
focus_issue <- c("Economy", "Employment", "Public Health", "Prime and Justice", "Immigration Policy", "Tax Policy", "")
# Do you agree with one or more of the following? Select all that apply.
agree_statements <- c("There should be policies to resolve the gap between the rich and the poor.", "Environment safety is more important than business tax revenue.", "There should be rules to include all religions in all political parties.", "The government should assist corporations in increasing employment.", "The government should pay more on public health programs.", "There should be more free trade with other countries, even if it hurts some industries in Canada.")
# Simuating data using the sample function
# setting sample size
n <- 500
# Simulating n samples answers to section 'Personal Background'
background <- tibble(basis = sample(x = basis, size=n, replace=TRUE), 
             citizenship = sample(x=citizenship, size=n, replace=TRUE, prob = c(0.8, 0.1, 0.1)),
             decade_born = sample(x=decade, size=n, replace=TRUE),
             education_level = sample(x=education, size=n, replace=TRUE, prob = c()), # [Education]
             gender = sample(x=gender, size=n, replace=TRUE, prob = c(0.4915, 0.4915, 0.017))# based on the referenced, that there exists 1.7% population identified them 'Non-binary' in Canada [NonBin].
             , employment_status = sample(x=employment, size=n, replace=TRUE))
# [Education] Reference https://www12.statcan.gc.ca/census-recensement/2016/dp-pd/hlt-fst/edu-sco/Table.cfm?Lang=E&T=11&Geo=00&SP=1&view=2&age=2&sex=1
# [NonBin] https://www.statcan.gc.ca/eng/dai/smr08/2015/smr08_203_2015
# Simulating n samples answering section 'Political Leanings'
political_leaning <- tibble(last_vote = sample(x=last_vote, size=n, replace=TRUE, prob=c(0.24, 0.24, 0.24, 0.24, 0.04)),
                            likely_vote = sample(x=likely_vote, size=n, replace=TRUE),
                            # party_vote = sample(x=party, size=n, replace=TRUE),
                            problem_focused = sample(x=problem, size=n, replace=TRUE),
                            right_direction = sample(x=right_dir, size=n, replace=TRUE, prob = c(0.495, 0.495, 0.01)),
                            # Based on the proportion of seats won.
                            will_vote = sample(x=party, size=n, replace=TRUE, prob = c(0.65, 0.30, 0.04, 0.005, 0.005)),
                            )
# Combining sections' Answers
election_data <- bind_cols(background, political_leaning)
election_data <- election_data %>% subset(citizenship=="Canadian Citizen")
```

```{r "Data Tuning based on Facts"}
# Research & References required

```

# I. Executive Summary:
  Petit Poll’s October polling update aim to help Ontario Liberal party to figure out what kind of policy do people care the most. We developed a survey on Google Form and simulated it in relation to the real-word circumstances, this means we are simulating based on the previous facts for example the percentage of voting in each party. We found that … This is important because the simulation result can be a reference for Liberal party to know what promise they make during the election will favor people in Ontario the most. However, one weakness is that our report is not based on the real respondent but only an assumption, so the actual result may vary from our result. Liberal party can take this survey as a template to release a survey on XXX to gain some true respondent.
  
# II. Introduction
  The 43rd Ontario General Election will be held on or before June 2, 2022. From 2003-2014, Liberal party was elected as premier in Ontario for more than 10 years (TVO, 2018). During the 2018 Ontario election, the Ontario Progressive Conservative Party, led by Doug Ford, won the majority government with 76 out of 124 seats, while the Ontario Liberal Party, led by Kathleen Wynne, recording the worst results in the party’s 161-year history and the worst results of any ruling party in Ontario with only, which dropped from 55 seats to only 7 seats (Dentons, 2018). After changing the leader of the Ontario Liberal Party, it is important for Liberal Party to gain more seats in the next coming election. One way for doing this is to find out what kind of policy do people in Ontario care so that the Liberal party would know what campaign promises our government should pursue, if elected.
  We developed a survey on Google Form and simulated it in relation to the real-word circumstances to find out which policy will interest people in Ontario the most.

# III. Methodology

```{r makeGraph1, echo = FALSE, fig.cap = "Distribution of which parties the samples voted in the previous election", fig.width= 6, fig.height=4}
# We use ggplot to generate the following figures
# Plotting the distribution of which parties were voted in the last election
last_vote_frame <- election_data %>% group_by(last_vote) %>% summarise(count = n(), .group = 'drop')
last_vote_figure <- ggplot(last_vote_frame, aes(x="last_vote", y=count, fill=last_vote)) + geom_bar(width = 2, stat = "identity") + coord_polar("y", start=0) + xlab("Party Voted")
last_vote_figure
```

```{r makeGraph2, echo = FALSE, fig.cap = "Distribution to question if the existing gov is bringing benefits to country?", fig.width= 6, fig.height=4}
# Answer distribution to question "Do you think the existing gov' is bringing benefits to country? "
benefit <- ggplot(election_data, aes(x=right_direction)) + geom_bar()
benefit
```

```{r makeGraph3, echo = FALSE, fig.cap = "Distribution of which parties to vote for in the next election", fig.width= 6, fig.height=4}
# Distribution of which parties to vote for in the next election.
next_vote_frame <- election_data %>% group_by(will_vote) %>% summarise(count = n(), .group = 'drop')
next_vote <- ggplot(next_vote_frame, aes(x="will_vote", y=count, fill=will_vote )) + geom_bar(width = 2, stat = "identity") + coord_polar("y", start=0)
next_vote
# Distribution of which parties to vote for in the next election; colors indicates whether the voter agrees that 
```

```{r makeGraph4, echo = FALSE, fig.cap = "Distribution of age", fig.width= 6, fig.height=4}
age_dist_problem_fill <- ggplot(election_data, aes(x=decade_born, fill=problem_focused)) + geom_bar()
age_dist_problem_fill

```

```{r makeGraph5, echo = FALSE, fig.cap = "Distribution of employment count", fig.width= 8, fig.height=4}
employment_count <- c()
for (i in 1:9){
  employment_count[i] <- ncol(election_data %>% filter(employment_status == employment[i]))
}
# employment_pie <- ggplot(election_data, aes(x="", y=employment_count, fill=employment_status)) + geom_bar(width=1, stat = "identity") + 
#   coord_polar("y", start=0)
# 
# employment_pie
employment_dist_dir_fill <- ggplot(election_data, aes(x=employment_status, fill = problem_focused)) + geom_bar() + coord_flip()
employment_dist_dir_fill
```

